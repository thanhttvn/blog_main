
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
    Thao  tác dữ liệu với Pandas | Code từ đâu - Code từ đầu
    </title>

    

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../favicon.png">

    <!--<link rel="stylesheet" type="text/css" href="/assets/css/screen.css?v=2fec92af86" />-->

    <link rel="stylesheet" href="../assets/css/bootstrap.min.css?v=2fec92af86">
    <link rel="stylesheet" href="../assets/css/monokai_sublime.css?v=2fec92af86">
    <link rel="stylesheet" href="../assets/css/default.css?v=2fec92af86">
<link rel="stylesheet" href="../assets/css/elusive-icons.min.css?v=2fec92af86">

    <meta name="description" content="Pandas là 1 open source, được cộng đồng đánh giá là high-performance, việc xử lý dữ liệu, tính toán sẽ dễ dàng hơn rất nhiều cách truyền thống.">
    <link rel="shortcut icon" href="../favicon.png" type="image/png">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="Code từ đâu - Code từ đầu">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Thao  tác dữ liệu với Pandas">
    <meta property="og:description" content="Pandas là 1 open source, được cộng đồng đánh giá là high-performance, việc xử lý dữ liệu, tính toán sẽ dễ dàng hơn rất nhiều cách truyền thống.">
    <meta property="og:url" content="http://codetudau.com/thao-tac-du-lieu-voi-pandas/">
    <meta property="article:published_time" content="2017-08-12T07:25:29.000Z">
    <meta property="article:modified_time" content="2017-08-27T14:45:13.000Z">
    <meta property="article:tag" content="pandas">
    <meta property="article:tag" content="python">
    <meta property="article:tag" content="BIG DATA">
    
    <meta property="article:publisher" content="https://www.facebook.com/passion1907">
    <meta property="article:author" content="https://www.facebook.com/passion1907">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Thao  tác dữ liệu với Pandas">
    <meta name="twitter:description" content="Pandas là 1 open source, được cộng đồng đánh giá là high-performance, việc xử lý dữ liệu, tính toán sẽ dễ dàng hơn rất nhiều cách truyền thống.">
    <meta name="twitter:url" content="http://codetudau.com/thao-tac-du-lieu-voi-pandas/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="T.T.T">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="pandas, python, BIG DATA">
    <meta name="twitter:site" content="@AdwardVn">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Code từ đâu - Code từ đầu",
        "logo": "http://codetudau.com/content/images/2017/08/kkkkkkkk.png"
    },
    "author": {
        "@type": "Person",
        "name": "T.T.T",
        "image": "http://codetudau.com/content/images/2017/08/IMG_0261.JPG",
        "url": "http://codetudau.com/author/lulz/",
        "sameAs": [
            "https://www.facebook.com/passion1907"
        ]
    },
    "headline": "Thao  tác dữ liệu với Pandas",
    "url": "http://codetudau.com/thao-tac-du-lieu-voi-pandas/",
    "datePublished": "2017-08-12T07:25:29.000Z",
    "dateModified": "2017-08-27T14:45:13.000Z",
    "keywords": "pandas, python, BIG DATA",
    "description": "Pandas là 1 open source, được cộng đồng đánh giá là high-performance, việc xử lý dữ liệu, tính toán sẽ dễ dàng hơn rất nhiều cách truyền thống.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://codetudau.com/"
    }
}
    </script>

    <script type="text/javascript" src="../public/ghost-sdk.js?v=2fec92af86"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "2575335f4165"
});
</script>
    <meta name="generator" content="Ghost 1.7">
    <link rel="alternate" type="application/rss+xml" title="Code từ đâu - Code từ đầu" href="../rss/index.html">

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40547934-3', 'auto');
  ga('send', 'pageview');

</script>
        <script type="text/javascript" src="../assets/js/jquery.js?v=2fec92af86"></script>

    <!--<link rel="stylesheet" href="/assets/css/default.css?v=2fec92af86">-->
    
    <script src="../assets/js/highlight.pack.js?v=2fec92af86"></script>
  
      <script>hljs.initHighlightingOnLoad();</script>


<script>

</script>
</head>
<body>
<div class="container">
<div class="row">
<div class="col-md-2 hidden-sm hidden-xs">

    <div class="logo">
<a class="blog-logo" href="../">
        <img class="blog-logo-image" src="../content/images/2017/08/kkkkkkkk.png" alt="Blog Logo">
</a>
    </div>


<h5>Code từ đâu - Code từ đầu</h5>
<hr>
<ul class="list-unstyled menu">
    <li>
        <a href="https://github.com/thanhttvn" target="_blank">
         <i class="el el-github"></i> GitHub
        </a>
    </li>

        <li>
            <a href="https://www.facebook.com/passion1907" target="_blank">
                <i class="el el-facebook"></i> Facebook
            </a>
        </li>

        <li>
            <a href="https://twitter.com/AdwardVn" target="_blank">
                <i class="el el-twitter"></i> @AdwardVn
            </a>
        </li>

    <li>
        <a href="skype:thanhtt.vn93?add" target="_blank">
            <i class="el el-skype"></i> thanhtt.vn93
        </a>

    </li>
</ul>



</div>
<div class="col-md-10 col-xs-12">
    

<a href="../" class="read-more"><i class="el el-caret-left read-more"></i> home</a>
<hr>





<main role="main">

    <article class="row post tag-pandas tag-python tag-bigdata">

        <header class="col-xs-12">
        <div class="col-md-10 no-margin no-padding post">
            <h1 class="title">
            Thao  tác dữ liệu với Pandas - Phần 1

            </h1>
             </div>
<div class="col-md-2">
            </div>

        </header>

        <section class="col-xs-12">
            <div class="kg-card-markdown"><h1 id="tisaophibitpandas">Tại sao phải biết Pandas</h1>
<p>Giống như muốn chăn rau, à trồng rau thì phải có cuốc, mặc dù không có cuốc thì dùng tay vẫn trồng được, nhưng mà có phải khổ hơn không. Trong việc xử lý dữ liệu với Python cũng thế, bạn không dùng Pandas cũng được, nhưng sẽ vất vả hơn rất nhiều.<br>
OK, xem pandas có gì hay nào.</p>
<h1 id="pandaslg">Pandas là gì</h1>
<p>Về cơ bản Pandas là 1 open source, được cộng đồng đánh giá là high-performance, việc xử lý dữ liệu, tính toán sẽ dễ dàng hơn rất nhiều cách truyền thống. OK, xem pandas có gì thú vị nào.</p>
<h1 id="todata">Tạo data</h1>
<p>Công việc đầu tiên là import thư viện Pandas và tạo Pandas DataFrame</p>
<pre><code class="language-python">import pandas as pd

#Tạo data cần dùng
df_sample =\
pd.DataFrame([["day1","day2","day1","day2","day1","day2"],
              ["A","B","A","B","C","C"],
              [100,150,200,150,100,50],
              [120,160,100,180,110,80]] ).T  

#Thêm tên column
df_sample.columns = ["day_no","class","score1","score2"]  
#Gắn thêm index
df_sample.index   = [11,12,13,14,15,16]
import pandas as pd

# Tạo data cần dùng
df_sample = pd.DataFrame([["day1", "day2", "day1", "day2", "day1", "day2"],
                          ["A", "B", "A", "B", "C", "C"],
                          [100, 150, 200, 150, 100, 50],
                          [120, 160, 100, 180, 110, 80]]).T

# Thêm tên column
df_sample.columns = ["day_no", "class", "score1", "score2"]

# Gắn với index
df_sample.index = [11, 12, 13, 14, 15, 16]
df_sample
#    day_no class score1 score2
# 11   day1     A    100    120
# 12   day2     B    150    160
# 13   day1     A    200    100
# 14   day2     B    150    180
# 15   day1     C    100    110
# 16   day2     C     50     80
</code></pre>
<h2 id="thaotcvicolumnindex">Thao tác với Column/Index</h2>
<p>Bạn có thể truy cập thay đổi index hoặc column như sau:</p>
<pre><code class="language-python"># Lấy tên của cột
df_sample.columns
# Index([u'day_no', u'class', u'score1', u'score2'], dtype='object')

# Lấy tên
df_sample.index
# Int64Index([11, 12, 13, 14, 15, 16], dtype='int64')

#Ghi đè tên columns
df_sample.columns = ["day_no","class","point1","point2"]

#Ghi đè index
df_sample.index = [11,12,13,14,15,16]

# Sử dụng method rename point1 →　point
df_sample.rename(columns={'point1': 'point'})
# day_no class point point2
# 11   day1     A   100    120
# 12   day2     B   150    160
# 13   day1     A   200    100
# 14   day2     B   150    180
# 15   day1     C   100    110
# 16   day2     C    50     80

</code></pre>
<h2 id="kimtrathngtincadata">Kiểm tra thông tin của data</h2>
<pre><code class="language-python"># Số row
len(df_sample)

# Kích thước data
#Trả về（số hàng、số cột)
df_sample.shape


# Thông tin từng column
df_sample.info()
# &lt;class 'pandas.core.frame.DataFrame'&gt;
# Int64Index: 6 entries, 11 to 16
# Data columns (total 4 columns):
# day_no    6 non-null object
# class     6 non-null object
# point1    6 non-null object
# point2    6 non-null object
# dtypes: object(4)
# memory usage: 240.0+ bytes

# Trả về các giá trị như TBC, phân tán, tứ phân vị
df_sample.describe()
#        day_no class  point1  point2
# count       6     6       6       6
# unique      2     3       4       6
# top      day1     B     150     110
# freq        3     2       2       1

# Hiển thị 10 dòng đầu tiên
df_sample.head(10)
</code></pre>
<h1 id="thaotcvidata">Thao tác với data</h1>
<p>Lấy 1 số cột theo ý muốn</p>
<pre><code class="language-python"># Với cách gọi như dưới chính là sử dụng method __get_item___
df_sample["day_no"]
# 11    day1
# 12    day2
# 13    day1
# 14    day2
# 15    day1
# 16    day2
# Name: day_no, dtype: object

# Giống như trên, nhưng muốn lấy nhiều cột một lúc
df_sample[["day_no","score1"]]

# Sử dụng loc
# Phương pháp ：iloc[rows, columns]
df_sample.loc[:,"day_no"]  # Muốn hiển thị cả cột thì thêm「:」
df_sample.loc[:,["day_no","score1"]] #TH muốn lấy nhiều cột một lúc

# Sử dụng iloc
# Phương pháp ：iloc[rows số bao nhiêu , column số bao nhiêu]
df_sample.iloc[:,0]
df_sample.iloc[:,0:2] #TH lấy nhiều cột


# Sử dụng ix
# Dùng số thứ tự hoặc tên cột đều được
df_sample.ix[:,"day_no"] # Tuy nhiên nếu lấy 1 cột thì KQ trả về dạng Pandas.Series Object
df_sample.ix[:,["day_no","score1"]] # Ngược lại, lấy nhiều cột thì là Pandas.Dataframe

df_sample.ix[0:4,"score1"] # hàng dùng số thứ tự, cột dùng tên cũng ok hết

series_bool = [True,False,True,False]
df_sample.ix[:,series_bool]  #Ngoài ra、lấy theo thứ tự array Boolean cũng được
# day_no class point1 point2
# 11   day1     A    100    120
# 12   day2     B    150    160
# 13   day1     A    200    100
# 14   day2     B    150    180
# 15   day1     C    100    110
# 16   day2     C     50     80


score_select = pd.Series(df_sample.columns).str.contains("score") # Xem có cột nào contains "score"
# 0    True 
# 1    False
# 2    False
# 3    False
df_sample.ix[:, np.array(score_select)]
</code></pre>
<h2 id="subsetting">Subsetting</h2>
<p>Lấy ra 1 phần data thoả mãn điều kiện</p>
<pre><code class="language-python">df_sample[df_sample.day_no == "day1"]  # Lọc ra nguyên row có day_no = day1
#    day_no class point1 point2
# 11   day1     A    100    120
# 13   day1     A    200    100
# 15   day1     C    100    110

# Cách khác là dùng arr boolean để lọc row dataframe như sau
series_bool = [True,False,True,False,True,False] #Lưu ý: số row = len(series_bool)
df_sample[series_bool]


#Sử dụng method query của Pandas
df_sample.query("day_no == 'day1'")
# So với cách trên không phải viết lại tên dataframe 2 lần :D
# Chú ý là điều kiện bắt buộc là str

# TH nhiều đkien or là "|" and là "&amp;"
df_sample.query("day_no == 'day1'|day_no == 'day2'")

# Nếu muốn sử dụng biến số
select_condition = "day1"
df_sample.query("day_no == select_condition")  # ☓ báo lỗi
# Do đkien bắt buộc là kiểu str nên muốn sử dụng biến số thì không thể viết kiểu thông thường, cần thêm @
df_sample.query("day_no == @select_condition")  # ◯ cách viết đúng


#Subsetting sử dụng index
df_sample.query("index == 11 ")  # Lấy row có index 11
df_sample.query("index  in [11,12] ") #　or là「in」
</code></pre>
<h2 id="sorting">Sorting</h2>
<p>Tiến hành sắp xếp lại</p>
<pre><code class="language-python">df_sample.sort_values("point1")  # Sort point1 theo thứ tự tăng dần
df_sample.sort_values(["point1","point2"])  # Sort 2 cột theo thứ tự tăng dần


df_sample.sort_values("point1",ascending=False)  #point1 giam dan
</code></pre>
<h2 id="pandasconcat">pandas.concat</h2>
<p>Tiến hành thêm cột, record</p>
<pre><code class="language-python">
# Thêm record
# Trước tiên phải tạo 1 DF cấu trúc giống DF hiện có
df_addition_row = pd.DataFrame([["day1","A",100,180]])
df_addition_row.columns =["day_no","class","point1","point2"]
df_addition_row.index   =[17] #Index đương nhiên phải khác nhau

pd.concat([df_sample,df_addition_row],axis=0)
# Axis=0: Kiểu kết hợp theo hướng thẳng đứng, -&gt; thêm cột thì axis = 1


# Thêm cột
# Thêm cột point3
df_addition_col = pd.DataFrame([[120,160,100,180,110,80]]).T #Tạo 1 DF có cột giống cấu trúc df_sample
df_addition_col.columns =["point3"]
df_addition_col.index   = [11,12,13,14,15,16]

pd.concat([df_sample,df_addition_col],axis=1)
</code></pre>
</div>
        </section>

        <footer class="col-xs-12 author">
            
            <hr>

      
        </footer>

    </article>
    
    <!--<div id="disqus_thread" class="post"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = ''; // required: replace example with your forum shortname
        var disqus_identifier = '';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>-->

</main>


</div>
        <div class="col-md-10 hidden-xs hidden-sm">
            <div class="subscribe-form">
                <form method="post" action="http://codetudau.com/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"><input class="location" type="hidden" name="location"><input class="referrer" type="hidden" name="referrer">

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email">
    </div>
    <button class="" type="submit"><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>


            </div>
        </div>


</div>
</div>

    <footer class="page-footer">
      <div class="container">
        <div class="row">
          <div class="col-xs-6">
          <i class="el el-stop footer-icon"></i>
            © 2017 <a href="../">Code từ đâu - Code từ đầu</a> All rights reserved.<br><br>
            Coder Ghost Theme created by <a href="https://www.mbejda.com">Milos Bejda</a>
          </div>
          <div class="col-xs-6 text-right hidden-sm hidden-xs">Proudly published with <a href="https://ghost.org">Ghost</a></div>
        </div>
      </div>
    </footer>

    <a href="index.html#" class="back-to-top"><span class="fa fa-angle-up fa-2x"></span></a>

    

    <script src="../assets/js/modernizr.js?v=2fec92af86"></script>
    <script type="text/javascript" src="../assets/js/index.js?v=2fec92af86"></script>

</body>
